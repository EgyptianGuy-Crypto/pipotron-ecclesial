---
import Layout from '../layouts/Layout.astro';

// Word lists from your screenshot
const wordLists = {
  starters: [
    "Avec", "Consid√©rant", "O√π que nous m√®ne", "Eu √©gard √†", "Vu",
    "En ce qui concerne", "Dans le cas particulier de"
  ],
  situations: [
    "la restriction", "l'orientation", "la crise", "l'inertie", 
    "la difficult√©", "l'aust√©rit√©", "la d√©gradation"
  ],
  qualifiers: [
    "pr√©sente", "actuelle", "g√©n√©rale", "induite", 
    "conjoncturelle", "observ√©e", "contextuelle"
  ],
  actions: [
    "il convient d#", "il faut", "on se doit d#", "il est pr√©f√©rable d#",
    "il serait int√©ressant d#", "il ne faut pas n√©gliger d#", "on ne peut se passer d#"
  ],
  verbs: [
    "√©tudier", "examiner", "favoriser", "prendre en consid√©ration",
    "anticiper", "imaginer", "uniformiser"
  ],
  quantities: [
    "toutes les", "chacune des", "la majorit√© des", "la simultan√©it√© des",
    "l'ensemble des", "la somme des", "la totalit√© des"
  ],
  solutions: [
    "solutions", "issues", "probl√©matiques", "voies", "alternatives",
    "organisations matricielles", "am√©liorations"
  ],
  outcomes: [
    "imaginables", "possibles", "s'offrant √† nous", "de bon sens",
    "envisageables", "√©ventuelles", "r√©alisables"
  ],
  timeframes: [
    "√† long terme", "pour longtemps", "√† l'avenir", "pour le futur",
    "depuis longtemps", "√† court terme", "rapidement"
  ]
};
---

<Layout title="Pipotron √âpiscopal">
  <div class="py-8">
    <!-- Title -->
    <h1 class="mb-8 text-4xl font-bold text-center">Pipotron √âpiscopal</h1>
    
    <!-- Official Document Result Area -->
    <div class="mb-8 mx-auto max-w-4xl">
      <div class="bg-white text-black rounded-lg shadow-2xl border-4 border-yellow-600 relative overflow-hidden">
        <!-- Official Header -->
        <div class="bg-gradient-to-r from-purple-900 to-blue-900 text-white p-4 text-center border-b-4 border-yellow-600">
          <div class="flex items-center justify-center space-x-4">
            <div class="w-12 h-12 bg-yellow-600 rounded-full flex items-center justify-center">
              <span class="text-2xl">‚úö</span>
            </div>
            <div>
              <h2 class="text-xl font-bold">CONF√âRENCE DES √âV√äQUES</h2>
              <p class="text-sm opacity-90">Communiqu√© Officiel</p>
            </div>
            <div class="w-12 h-12 bg-yellow-600 rounded-full flex items-center justify-center">
              <span class="text-2xl">‚úö</span>
            </div>
          </div>
        </div>
        
        <!-- Document Content -->
        <div class="p-8">
          <div id="result" class="min-h-32 flex items-center justify-center">
            <p class="text-gray-500 text-center italic">
              Cliquez sur "G√©n√©rer un nouveau" pour cr√©er un communiqu√© officiel
            </p>
          </div>
        </div>
        
        <!-- Official Footer -->
        <div class="bg-gray-100 p-4 border-t-2 border-gray-300">
          <div class="flex justify-between items-center text-sm text-gray-600">
            <div>
              <p class="font-semibold">Document confidentiel</p>
              <p>Usage interne uniquement</p>
            </div>
            <div class="text-right">
              <p id="document-date"></p>
              <p>R√©f: CE-2024-<span id="document-ref"></span></p>
            </div>
          </div>
        </div>
        
        <!-- Decorative corners -->
        <div class="absolute top-0 left-0 w-8 h-8 border-l-4 border-t-4 border-yellow-600"></div>
        <div class="absolute top-0 right-0 w-8 h-8 border-r-4 border-t-4 border-yellow-600"></div>
        <div class="absolute bottom-0 left-0 w-8 h-8 border-l-4 border-b-4 border-yellow-600"></div>
        <div class="absolute bottom-0 right-0 w-8 h-8 border-r-4 border-b-4 border-yellow-600"></div>
      </div>
    </div>

    <!-- Generate Button -->
    <div class="text-center mb-8">
      <button 
        id="generateBtn" 
        class="btn btn-lg bg-yellow-600 text-black hover:bg-yellow-700 font-semibold"
      >
        üìú G√©n√©rer un nouveau communiqu√©
      </button>
    </div>

    <!-- Instructions -->
    <div class="mb-8 p-4 bg-white/5 rounded-lg border border-white/10">
      <p class="text-center text-white/90">
        Ou composez manuellement votre communiqu√© en s√©lectionnant dans les listes ci-dessous
      </p>
    </div>

    <!-- Word Lists Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Column 1 -->
      <div class="space-y-6">
        <div class="bg-white/5 rounded-lg p-4 border border-white/10">
          <label class="block text-white font-medium mb-3">D√©but</label>
          <select 
            id="starters" 
            class="w-full p-3 bg-white/10 border border-white/20 rounded text-white" 
            size="6"
          >
            <option value="">-- Choisir --</option>
            {wordLists.starters.map(word => <option value={word}>{word}</option>)}
          </select>
        </div>
        
        <div class="bg-white/5 rounded-lg p-4 border border-white/10">
          <label class="block text-white font-medium mb-3">Action</label>
          <select 
            id="actions" 
            class="w-full p-3 bg-white/10 border border-white/20 rounded text-white" 
            size="6"
          >
            <option value="">-- Choisir --</option>
            {wordLists.actions.map(word => <option value={word}>{word}</option>)}
          </select>
        </div>
        
        <div class="bg-white/5 rounded-lg p-4 border border-white/10">
          <label class="block text-white font-medium mb-3">Solutions</label>
          <select 
            id="solutions" 
            class="w-full p-3 bg-white/10 border border-white/20 rounded text-white" 
            size="6"
          >
            <option value="">-- Choisir --</option>
            {wordLists.solutions.map(word => <option value={word}>{word}</option>)}
          </select>
        </div>
      </div>

      <!-- Column 2 -->
      <div class="space-y-6">
        <div class="bg-white/5 rounded-lg p-4 border border-white/10">
          <label class="block text-white font-medium mb-3">Situation</label>
          <select 
            id="situations" 
            class="w-full p-3 bg-white/10 border border-white/20 rounded text-white" 
            size="6"
          >
            <option value="">-- Choisir --</option>
            {wordLists.situations.map(word => <option value={word}>{word}</option>)}
          </select>
        </div>
        
        <div class="bg-white/5 rounded-lg p-4 border border-white/10">
          <label class="block text-white font-medium mb-3">Verbe</label>
          <select 
            id="verbs" 
            class="w-full p-3 bg-white/10 border border-white/20 rounded text-white" 
            size="6"
          >
            <option value="">-- Choisir --</option>
            {wordLists.verbs.map(word => <option value={word}>{word}</option>)}
          </select>
        </div>
        
        <div class="bg-white/5 rounded-lg p-4 border border-white/10">
          <label class="block text-white font-medium mb-3">R√©sultat</label>
          <select 
            id="outcomes" 
            class="w-full p-3 bg-white/10 border border-white/20 rounded text-white" 
            size="6"
          >
            <option value="">-- Choisir --</option>
            {wordLists.outcomes.map(word => <option value={word}>{word}</option>)}
          </select>
        </div>
      </div>

      <!-- Column 3 -->
      <div class="space-y-6">
        <div class="bg-white/5 rounded-lg p-4 border border-white/10">
          <label class="block text-white font-medium mb-3">Qualificatif</label>
          <select 
            id="qualifiers" 
            class="w-full p-3 bg-white/10 border border-white/20 rounded text-white" 
            size="6"
          >
            <option value="">-- Choisir --</option>
            {wordLists.qualifiers.map(word => <option value={word}>{word}</option>)}
          </select>
        </div>
        
        <div class="bg-white/5 rounded-lg p-4 border border-white/10">
          <label class="block text-white font-medium mb-3">Quantit√©</label>
          <select 
            id="quantities" 
            class="w-full p-3 bg-white/10 border border-white/20 rounded text-white" 
            size="6"
          >
            <option value="">-- Choisir --</option>
            {wordLists.quantities.map(word => <option value={word}>{word}</option>)}
          </select>
        </div>
        
        <div class="bg-white/5 rounded-lg p-4 border border-white/10">
          <label class="block text-white font-medium mb-3">Temporalit√©</label>
          <select 
            id="timeframes" 
            class="w-full p-3 bg-white/10 border border-white/20 rounded text-white" 
            size="7"
          >
            <option value="">-- Choisir --</option>
            {wordLists.timeframes.map(word => <option value={word}>{word}</option>)}
          </select>
        </div>
      </div>
    </div>

    <!-- Reset Button -->
    <div class="text-center mt-8">
      <button 
        id="resetBtn" 
        class="btn bg-white/10 text-white hover:bg-white/20"
      >
        üîÑ R√©initialiser
      </button>
    </div>
  </div>

  <script>
    // Set document date and reference number
    document.getElementById('document-date').textContent = new Date().toLocaleDateString('fr-FR');
    document.getElementById('document-ref').textContent = Math.floor(Math.random() * 9999).toString().padStart(4, '0');

    const wordLists = {
      starters: ["Avec", "Consid√©rant", "O√π que nous m√®ne", "Eu √©gard √†", "Vu", "En ce qui concerne", "Dans le cas particulier de"],
      situations: ["la restriction", "l'orientation", "la crise", "l'inertie", "la difficult√©", "l'aust√©rit√©", "la d√©gradation"],
      qualifiers: ["pr√©sente", "actuelle", "g√©n√©rale", "induite", "conjoncturelle", "observ√©e", "contextuelle"],
      actions: ["il convient d#", "il faut", "on se doit d#", "il est pr√©f√©rable d#", "il serait int√©ressant d#", "il ne faut pas n√©gliger d#", "on ne peut se passer d#"],
      verbs: ["√©tudier", "examiner", "favoriser", "prendre en consid√©ration", "anticiper", "imaginer", "uniformiser"],
      quantities: ["toutes les", "chacune des", "la majorit√© des", "la simultan√©it√© des", "l'ensemble des", "la somme des", "la totalit√© des"],
      solutions: ["solutions", "issues", "probl√©matiques", "voies", "alternatives", "organisations matricielles", "am√©liorations"],
      outcomes: ["imaginables", "possibles", "s'offrant √† nous", "de bon sens", "envisageables", "√©ventuelles", "r√©alisables"],
      timeframes: ["√† long terme", "pour longtemps", "√† l'avenir", "pour le futur", "depuis longtemps", "√† court terme", "rapidement"]
    };

    function getRandomItem(array) {
      return array[Math.floor(Math.random() * array.length)];
    }

    function generateSentence() {
      const starter = getRandomItem(wordLists.starters);
      const situation = getRandomItem(wordLists.situations);
      const qualifier = getRandomItem(wordLists.qualifiers);
      const action = getRandomItem(wordLists.actions);
      const verb = getRandomItem(wordLists.verbs);
      const quantity = getRandomItem(wordLists.quantities);
      const solution = getRandomItem(wordLists.solutions);
      const outcome = getRandomItem(wordLists.outcomes);
      const timeframe = getRandomItem(wordLists.timeframes);

      let processedAction = action.replace('d#', verb.startsWith('a') || verb.startsWith('e') || verb.startsWith('i') || verb.startsWith('o') || verb.startsWith('u') ? "d'" : "de");

      const sentence = `${starter} ${situation} ${qualifier}, ${processedAction} ${verb} ${quantity} ${solution} ${outcome} ${timeframe}.`;
      
      return sentence;
    }

    document.getElementById('generateBtn').addEventListener('click', function() {
      const sentence = generateSentence();
      document.getElementById('result').innerHTML = `
        <div class="text-center">
          <p class="text-lg font-medium text-gray-800 leading-relaxed mb-4">${sentence}</p>
          <div class="text-sm text-gray-600 italic">
            <p>¬´ Dans un esprit de mis√©ricorde et de dialogue constructif ¬ª</p>
          </div>
        </div>
      `;
      
      // Update document reference
      document.getElementById('document-ref').textContent = Math.floor(Math.random() * 9999).toString().padStart(4, '0');
    });

    document.getElementById('resetBtn').addEventListener('click', function() {
      const selects = document.querySelectorAll('select');
      selects.forEach(select => {
        select.selectedIndex = 0;
      });
      document.getElementById('result').innerHTML = `<p class="text-gray-500 text-center italic">Cliquez sur "G√©n√©rer un nouveau" pour cr√©er un communiqu√© officiel</p>`;
    });

    const selects = document.querySelectorAll('select');
    selects.forEach(select => {
      select.addEventListener('change', function() {
        updateManualSentence();
      });
    });

    function updateManualSentence() {
      const selectedValues = {};
      selects.forEach(select => {
        if (select.value) {
          selectedValues[select.id] = select.value;
        }
      });

      if (Object.keys(selectedValues).length > 0) {
        let sentence = "";
        const keys = ['starters', 'situations', 'qualifiers', 'actions', 'verbs', 'quantities', 'solutions', 'outcomes', 'timeframes'];
        
        keys.forEach(key => {
          if (selectedValues[key]) {
            if (key === 'actions' && selectedValues[key].includes('d#')) {
              const verb = selectedValues.verbs || '√©tudier';
              const processedAction = selectedValues[key].replace('d#', verb.startsWith('a') || verb.startsWith('e') || verb.startsWith('i') || verb.startsWith('o') || verb.startsWith('u') ? "d'" : "de");
              sentence += processedAction + " ";
            } else {
              sentence += selectedValues[key] + " ";
            }
          }
        });

        if (sentence.trim()) {
          document.getElementById('result').innerHTML = `
            <div class="text-center">
              <p class="text-lg font-medium text-gray-800 leading-relaxed mb-4">${sentence.trim()}.</p>
              <div class="text-sm text-gray-600 italic">
                <p>¬´ Dans un esprit de mis√©ricorde et de dialogue constructif ¬ª</p>
              </div>
            </div>
          `;
        }
      }
    }
  </script>
</Layout>
