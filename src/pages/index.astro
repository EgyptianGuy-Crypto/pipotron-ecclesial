---
// Word lists from your screenshot
const wordLists = {
  starters: [
    "Avec",
    "Considérant", 
    "Où que nous mène",
    "Eu égard à",
    "Vu",
    "En ce qui concerne",
    "Dans le cas particulier de"
  ],
  situations: [
    "la restriction",
    "l'orientation",
    "la crise",
    "l'inertie",
    "la difficulté",
    "l'austérité",
    "la dégradation"
  ],
  qualifiers: [
    "présente",
    "actuelle",
    "générale",
    "induite",
    "conjoncturelle",
    "observée",
    "contextuelle"
  ],
  actions: [
    "il convient d#",
    "il faut",
    "on se doit d#",
    "il est préférable d#",
    "il serait intéressant d#",
    "il ne faut pas négliger d#",
    "on ne peut se passer d#"
  ],
  verbs: [
    "étudier",
    "examiner",
    "favoriser",
    "prendre en considération",
    "anticiper",
    "imaginer",
    "uniformiser"
  ],
  quantities: [
    "toutes les",
    "chacune des",
    "la majorité des",
    "la simultanéité des",
    "l'ensemble des",
    "la somme des",
    "la totalité des"
  ],
  solutions: [
    "solutions",
    "issues",
    "problématiques",
    "voies",
    "alternatives",
    "organisations matricielles",
    "améliorations"
  ],
  outcomes: [
    "imaginables",
    "possibles",
    "s'offrant à nous",
    "de bon sens",
    "envisageables",
    "éventuelles",
    "réalisables"
  ],
  timeframes: [
    "à long terme",
    "pour longtemps",
    "à l'avenir",
    "pour le futur",
    "depuis longtemps",
    "à court terme",
    "rapidement"
  ]
};
---

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>Pipotron Épiscopal</title>
  </head>
  <body class="bg-gray-50 min-h-screen">
    <div class="max-w-6xl mx-auto px-6 py-8">
      <!-- Title -->
      <h1 class="text-4xl font-bold text-center text-gray-800 mb-12">Pipotron Épiscopal</h1>
      
      <!-- Result Area - Big and Centered -->
      <div class="mb-12">
        <div id="result" class="bg-white rounded-lg shadow-lg p-8 border-l-4 border-blue-500 min-h-32 flex items-center justify-center">
          <p class="text-gray-500 text-lg text-center">Cliquez sur "Générer un nouveau" pour créer une phrase automatiquement</p>
        </div>
      </div>

      <!-- Generate Button -->
      <div class="text-center mb-12">
        <button 
          id="generateBtn" 
          class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-8 py-3 rounded-lg shadow-md transition-colors duration-200"
        >
          Générer un nouveau
        </button>
      </div>

      <!-- Instructions -->
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8">
        <p class="text-blue-800 text-center">
          Ou composez manuellement votre phrase en sélectionnant dans les listes ci-dessous
        </p>
      </div>

      <!-- Word Lists Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Column 1 -->
        <div class="space-y-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Début</label>
            <select id="starters" class="w-full p-3 border border-gray-300 rounded-lg bg-white shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" size="7">
              <option value="">-- Choisir --</option>
              {wordLists.starters.map(word => <option value={word}>{word}</option>)}
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Action</label>
            <select id="actions" class="w-full p-3 border border-gray-300 rounded-lg bg-white shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" size="7">
              <option value="">-- Choisir --</option>
              {wordLists.actions.map(word => <option value={word}>{word}</option>)}
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Solutions</label>
            <select id="solutions" class="w-full p-3 border border-gray-300 rounded-lg bg-white shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" size="7">
              <option value="">-- Choisir --</option>
              {wordLists.solutions.map(word => <option value={word}>{word}</option>)}
            </select>
          </div>
        </div>

        <!-- Column 2 -->
        <div class="space-y-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Situation</label>
            <select id="situations" class="w-full p-3 border border-gray-300 rounded-lg bg-white shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" size="7">
              <option value="">-- Choisir --</option>
              {wordLists.situations.map(word => <option value={word}>{word}</option>)}
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Verbe</label>
            <select id="verbs" class="w-full p-3 border border-gray-300 rounded-lg bg-white shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" size="7">
              <option value="">-- Choisir --</option>
              {wordLists.verbs.map(word => <option value={word}>{word}</option>)}
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Résultat</label>
            <select id="outcomes" class="w-full p-3 border border-gray-300 rounded-lg bg-white shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" size="7">
              <option value="">-- Choisir --</option>
              {wordLists.outcomes.map(word => <option value={word}>{word}</option>)}
            </select>
          </div>
        </div>

        <!-- Column 3 -->
        <div class="space-y-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Qualificatif</label>
            <select id="qualifiers" class="w-full p-3 border border-gray-300 rounded-lg bg-white shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" size="7">
              <option value="">-- Choisir --</option>
              {wordLists.qualifiers.map(word => <option value={word}>{word}</option>)}
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Quantité</label>
            <select id="quantities" class="w-full p-3 border border-gray-300 rounded-lg bg-white shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" size="7">
              <option value="">-- Choisir --</option>
              {wordLists.quantities.map(word => <option value={word}>{word}</option>)}
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Temporalité</label>
            <select id="timeframes" class="w-full p-3 border border-gray-300 rounded-lg bg-white shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" size="8">
              <option value="">-- Choisir --</option>
              {wordLists.timeframes.map(word => <option value={word}>{word}</option>)}
            </select>
          </div>
        </div>
      </div>

      <!-- Reset Button -->
      <div class="text-center mt-8">
        <button 
          id="resetBtn" 
          class="bg-gray-500 hover:bg-gray-600 text-white font-semibold px-6 py-2 rounded-lg shadow-md transition-colors duration-200"
        >
          Réinitialiser
        </button>
      </div>
    </div>

    <script>
      // Get all the word lists from the server
      const wordLists = {
        starters: ["Avec", "Considérant", "Où que nous mène", "Eu égard à", "Vu", "En ce qui concerne", "Dans le cas particulier de"],
        situations: ["la restriction", "l'orientation", "la crise", "l'inertie", "la difficulté", "l'austérité", "la dégradation"],
        qualifiers: ["présente", "actuelle", "générale", "induite", "conjoncturelle", "observée", "contextuelle"],
        actions: ["il convient d#", "il faut", "on se doit d#", "il est préférable d#", "il serait intéressant d#", "il ne faut pas négliger d#", "on ne peut se passer d#"],
        verbs: ["étudier", "examiner", "favoriser", "prendre en considération", "anticiper", "imaginer", "uniformiser"],
        quantities: ["toutes les", "chacune des", "la majorité des", "la simultanéité des", "l'ensemble des", "la somme des", "la totalité des"],
        solutions: ["solutions", "issues", "problématiques", "voies", "alternatives", "organisations matricielles", "améliorations"],
        outcomes: ["imaginables", "possibles", "s'offrant à nous", "de bon sens", "envisageables", "éventuelles", "réalisables"],
        timeframes: ["à long terme", "pour longtemps", "à l'avenir", "pour le futur", "depuis longtemps", "à court terme", "rapidement"]
      };

      function getRandomItem(array) {
        return array[Math.floor(Math.random() * array.length)];
      }

      function generateSentence() {
        const starter = getRandomItem(wordLists.starters);
        const situation = getRandomItem(wordLists.situations);
        const qualifier = getRandomItem(wordLists.qualifiers);
        const action = getRandomItem(wordLists.actions);
        const verb = getRandomItem(wordLists.verbs);
        const quantity = getRandomItem(wordLists.quantities);
        const solution = getRandomItem(wordLists.solutions);
        const outcome = getRandomItem(wordLists.outcomes);
        const timeframe = getRandomItem(wordLists.timeframes);

        // Handle the d# replacement
        let processedAction = action.replace('d#', verb.startsWith('a') || verb.startsWith('e') || verb.startsWith('i') || verb.startsWith('o') || verb.startsWith('u') ? "d'" : "de");

        const sentence = `${starter} ${situation} ${qualifier}, ${processedAction} ${verb} ${quantity} ${solution} ${outcome} ${timeframe}.`;
        
        return sentence;
      }

      document.getElementById('generateBtn').addEventListener('click', function() {
        const sentence = generateSentence();
        document.getElementById('result').innerHTML = `<p class="text-2xl text-gray-800 text-center leading-relaxed">${sentence}</p>`;
      });

      // Reset button functionality
      document.getElementById('resetBtn').addEventListener('click', function() {
        const selects = document.querySelectorAll('select');
        selects.forEach(select => {
          select.selectedIndex = 0;
        });
        document.getElementById('result').innerHTML = `<p class="text-gray-500 text-lg text-center">Cliquez sur "Générer un nouveau" pour créer une phrase automatiquement</p>`;
      });

      // Manual selection functionality
      const selects = document.querySelectorAll('select');
      selects.forEach(select => {
        select.addEventListener('change', function() {
          updateManualSentence();
        });
      });

      function updateManualSentence() {
        const selectedValues = {};
        selects.forEach(select => {
          if (select.value) {
            selectedValues[select.id] = select.value;
          }
        });

        if (Object.keys(selectedValues).length > 0) {
          let sentence = "";
          const keys = ['starters', 'situations', 'qualifiers', 'actions', 'verbs', 'quantities', 'solutions', 'outcomes', 'timeframes'];
          
          keys.forEach(key => {
            if (selectedValues[key]) {
              if (key === 'actions' && selectedValues[key].includes('d#')) {
                const verb = selectedValues.verbs || 'étudier';
                const processedAction = selectedValues[key].replace('d#', verb.startsWith('a') || verb.startsWith('e') || verb.startsWith('i') || verb.startsWith('o') || verb.startsWith('u') ? "d'" : "de");
                sentence += processedAction + " ";
              } else {
                sentence += selectedValues[key] + " ";
              }
            }
          });

          if (sentence.trim()) {
            document.getElementById('result').innerHTML = `<p class="text-2xl text-gray-800 text-center leading-relaxed">${sentence.trim()}.</p>`;
          }
        }
      }
    </script>
  </body>
</html>
